# GENERATED FILE - DO NOT EDIT!
# Update with: bazel run //.circleci:write_merged_config
version: 2.1
workflows:
  aspect-workflows:
    jobs:
    - aw-auto-deliver:
        context: []
        filters:
          branches:
            only:
            - /^main$/
            - /^aspect-build\/test-delivery$/
        requires:
        - aw-root_workspace_test
    - aw-buildifier:
        context: []
        workspace: .
    - aw-configure:
        context: []
        workspace: .
    - aw-format:
        context: []
        workspace: .
    - aw-gazelle:
        context: []
        workspace: .
    - aw-root_workspace_test:
        context: []
        workspace: .
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - scheduled_pipeline
          - << pipeline.trigger_source >>
  aspect-workflows-e2e-copy_to_directory:
    jobs:
    - aw-test:
        context: []
        delivery_manifest: false
        workspace: e2e/copy_to_directory
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - scheduled_pipeline
          - << pipeline.trigger_source >>
  aspect-workflows-e2e-coreutils:
    jobs:
    - aw-test:
        context: []
        delivery_manifest: false
        workspace: e2e/coreutils
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - scheduled_pipeline
          - << pipeline.trigger_source >>
  aspect-workflows-e2e-external_copy_to_directory:
    jobs:
    - aw-test:
        context: []
        delivery_manifest: false
        workspace: e2e/external_copy_to_directory
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - scheduled_pipeline
          - << pipeline.trigger_source >>
  aspect-workflows-e2e-smoke:
    jobs:
    - aw-test:
        context: []
        delivery_manifest: false
        workspace: e2e/smoke
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - scheduled_pipeline
          - << pipeline.trigger_source >>
  aspect-workflows-manual-deliver:
    jobs:
    - aw-manual-deliver:
        context: []
    when:
      equal:
      - true
      - << pipeline.parameters.perform_delivery >>
  aspect-workflows-warming:
    jobs:
    - aw-warming: {}
    when:
      and:
      - equal:
        - scheduled_pipeline
        - << pipeline.trigger_source >>
      - equal:
        - aspect-workflows-warming
        - << pipeline.schedule.name >>
  user-workflow:
    jobs:
    - user-job
    when:
      and:
      - not: << pipeline.parameters.perform_delivery >>
      - not:
          equal:
          - << pipeline.trigger_source >>
          - scheduled_pipeline
jobs:
  aw-auto-deliver:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      CC: /bin/false
      DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    resource_class: aspect-build/bazel-lib
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: git fetch
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Git fetch
    - when:
        condition: << pipeline.parameters.delivery_commit >>
        steps:
        - run:
            command: git checkout << pipeline.parameters.delivery_commit >>
            environment:
              ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
              CC: /bin/false
              DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
              XDG_CACHE_HOME: /mnt/ephemeral/caches
            name: Checkout release commit
    - run:
        command: rosetta run delivery
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Delivery
        no_output_timeout: 180m
    working_directory: /mnt/ephemeral/workdir
  aw-buildifier:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib-small
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run buildifier --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Buildifier
        no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-configure:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib-small
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run configure --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure
        no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-format:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib-small
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run format --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Format
        no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-gazelle:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib-small
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run gazelle --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Gazelle
        no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-manual-deliver:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      CC: /bin/false
      DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
      DELIVERY_TARGETS: << pipeline.parameters.delivery_targets >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    resource_class: aspect-build/bazel-lib
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: git fetch
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Git fetch
    - when:
        condition: << pipeline.parameters.delivery_commit >>
        steps:
        - run:
            command: git checkout << pipeline.parameters.delivery_commit >>
            environment:
              ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
              CC: /bin/false
              DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
              XDG_CACHE_HOME: /mnt/ephemeral/caches
            name: Checkout release commit
    - run:
        command: rosetta run delivery
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          DELIVERY_COMMIT: << pipeline.parameters.delivery_commit >>
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Delivery
        no_output_timeout: 180m
    working_directory: /mnt/ephemeral/workdir
  aw-root_workspace_test:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run test --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Test
        no_output_timeout: 180m
    - store_test_results:
        path: /some/path/testlogs
    - when:
        condition:
          and:
          - <<parameters.delivery_manifest>>
          - or:
            - matches:
                pattern: ^main$
                value: << pipeline.git.branch >>
            - matches:
                pattern: ^aspect-build\/test-delivery$
                value: << pipeline.git.branch >>
        steps:
        - run:
            command: rosetta run delivery_manifest --workspace << parameters.workspace
              >> --data TARGETS_SOURCE=test
            environment:
              ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
              CC: /bin/false
              XDG_CACHE_HOME: /mnt/ephemeral/caches
            name: Delivery Manifest
            no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/testlogs
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-test:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      ASPECT_WORKFLOWS_WORKSPACE: << parameters.workspace >>
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    parameters:
      delivery_manifest:
        default: true
        type: boolean
      workspace:
        type: string
    resource_class: aspect-build/bazel-lib-small
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: rm -rf /some/path/artifacts /some/path/testlogs
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Prepare archive directories
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run branch_freshness
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Branch Freshness
        no_output_timeout: 180m
    - run:
        command: rosetta run test --workspace << parameters.workspace >>
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Test
        no_output_timeout: 180m
    - store_test_results:
        path: /some/path/testlogs
    - when:
        condition:
          and:
          - <<parameters.delivery_manifest>>
          - or:
            - matches:
                pattern: ^main$
                value: << pipeline.git.branch >>
            - matches:
                pattern: ^aspect-build\/test-delivery$
                value: << pipeline.git.branch >>
        steps:
        - run:
            command: rosetta run delivery_manifest --workspace << parameters.workspace
              >> --data TARGETS_SOURCE=test
            environment:
              ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
              CC: /bin/false
              XDG_CACHE_HOME: /mnt/ephemeral/caches
            name: Delivery Manifest
            no_output_timeout: 180m
    - store_artifacts:
        path: /some/path/testlogs
    - store_artifacts:
        path: /some/path/artifacts
    - run:
        command: rosetta run finalization
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Finalization
        no_output_timeout: 10m
        when: always
    working_directory: /mnt/ephemeral/workdir
  aw-warming:
    environment:
      ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
      XDG_CACHE_HOME: /mnt/ephemeral/caches
    machine: true
    resource_class: aspect-build/bazel-lib-warming
    steps:
    - run:
        command: /etc/aspect/workflows/bin/configure_workflows_env
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Configure Workflows
    - checkout
    - run:
        command: /etc/aspect/workflows/bin/agent_health_check
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Agent health checks
        no_output_timeout: 180m
    - run:
        command: rosetta run warming --workspace e2e/external_copy_to_directory
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Create warming archive for e2e/external_copy_to_directory
        no_output_timeout: 180m
    - run:
        command: rosetta run warming --workspace e2e/copy_to_directory
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Create warming archive for e2e/copy_to_directory
        no_output_timeout: 180m
    - run:
        command: rosetta run warming --workspace e2e/coreutils
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Create warming archive for e2e/coreutils
        no_output_timeout: 180m
    - run:
        command: rosetta run warming --workspace e2e/smoke
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Create warming archive for e2e/smoke
        no_output_timeout: 180m
    - run:
        command: rosetta run warming --workspace .
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Create warming archive for root
        no_output_timeout: 180m
    - run:
        command: /etc/aspect/workflows/bin/warming_archive
        environment:
          ASPECT_WORKFLOWS_CONFIG: .aspect/workflows/config.yaml
          CC: /bin/false
          XDG_CACHE_HOME: /mnt/ephemeral/caches
        name: Archive warming tars
    working_directory: /mnt/ephemeral/workdir
  user-job:
    docker:
    - image: cimg/base:2024.01
    steps:
    - checkout
    - run: echo "Example user CircleCI job that is not generated by Aspect Workflows."
parameters:
  delivery_commit:
    default: ""
    description: The commit to checkout and run the delivery from. Targets listed
      in the delivery manifest for this commit will be delivered unless specific targets
      are listed in `delivery_targets`.
    type: string
  delivery_targets:
    default: ""
    description: List of Bazel targets to deliver, delimited by spaces. For example,
      `//app/a:push_release //app/b:push_release`. If empty, targets listed in the
      delivery manifest for the target commit will be delivered.
    type: string
  perform_delivery:
    default: false
    type: boolean
