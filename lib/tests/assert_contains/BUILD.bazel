load("//lib:testing.bzl", "assert_contains")

# Special characters within expected string: https://github.com/aspect-build/rules_js/issues/1045

assert_contains(
    name = "regexy-args-1",
    actual = ":case1.txt",
    expected = "--arg1='/{{[{]?(.*?)[}]?}}/'",
    target_compatible_with = select({
        "@bazel_lib//lib:enable_runfiles": [],
        "//conditions:default": ["@platforms//:incompatible"],
    }),
)

assert_contains(
    name = "regexy-args-2",
    actual = ":case1.txt",
    expected = "--arg2='/{%(.*?)%}/'",
    target_compatible_with = select({
        "@bazel_lib//lib:enable_runfiles": [],
        "//conditions:default": ["@platforms//:incompatible"],
    }),
)

assert_contains(
    name = "backtick",
    actual = ":case1.txt",
    expected = "`ff`",
    target_compatible_with = select({
        "@bazel_lib//lib:enable_runfiles": [],
        "//conditions:default": ["@platforms//:incompatible"],
    }),
)
